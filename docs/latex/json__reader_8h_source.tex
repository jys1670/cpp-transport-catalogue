\hypertarget{json__reader_8h_source}{}\doxysection{json\+\_\+reader.\+h}
\label{json__reader_8h_source}\index{transport-\/catalogue/json\_reader.h@{transport-\/catalogue/json\_reader.h}}
\mbox{\hyperlink{json__reader_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <string\_view>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{domain_8h}{domain.h}}"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{json_8h}{json.h}}"{}}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{map__renderer_8h}{map\_renderer.h}}"{}}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{request__handler_8h}{request\_handler.h}}"{}}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacejson}{json}} \{}
\DoxyCodeLine{22 }
\DoxyCodeLine{33 \textcolor{keyword}{class }\mbox{\hyperlink{classjson_1_1JsonReader}{JsonReader}} \{}
\DoxyCodeLine{34 \textcolor{keyword}{public}:}
\DoxyCodeLine{43   \textcolor{keyword}{explicit} \mbox{\hyperlink{classjson_1_1JsonReader_a49fbeaaef8d3698cae1d6e65bcd1b7a5}{JsonReader}}(\mbox{\hyperlink{classcore_1_1TransportCatalogue}{core::TransportCatalogue}} \&catalogue,}
\DoxyCodeLine{44                       \mbox{\hyperlink{classcore_1_1RequestHandler}{core::RequestHandler}} \&req\_handler)}
\DoxyCodeLine{45       : \mbox{\hyperlink{classjson_1_1JsonReader_a0ae996e195f14f7542c53414497c2fa2}{catalogue\_}}\{catalogue\}, \mbox{\hyperlink{classjson_1_1JsonReader_a8321a0cc06e0e2e04e73c6622471e1ba}{req\_handler\_}}\{req\_handler\} \{\};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47   \textcolor{keywordtype}{void} ProcessInput(}
\DoxyCodeLine{48       \textcolor{keyword}{const} \mbox{\hyperlink{namespacejson_a14165bfd985e982794b3697b71cc4a01}{json::Dict}} \&doc\_map,}
\DoxyCodeLine{49       \mbox{\hyperlink{namespaceinput__info_a3ecc5b6b1fd2d6e7aecf01c04dc54f00}{input\_info::OutputFormat}} format = input\_info::OutputFormat::Json);}
\DoxyCodeLine{50   \textcolor{keywordtype}{void} ProcessBaseReqs(\textcolor{keyword}{const} \mbox{\hyperlink{namespacejson_a14165bfd985e982794b3697b71cc4a01}{json::Dict}} \&doc\_map);}
\DoxyCodeLine{51   \textcolor{keywordtype}{void} EnqueueRenderSettingsUpdate(\textcolor{keyword}{const} \mbox{\hyperlink{namespacejson_a14165bfd985e982794b3697b71cc4a01}{json::Dict}} \&doc\_map);}
\DoxyCodeLine{52   \textcolor{keywordtype}{void} EnqueueRoutingSettingsUpdate(\textcolor{keyword}{const} \mbox{\hyperlink{namespacejson_a14165bfd985e982794b3697b71cc4a01}{json::Dict}} \&doc\_map);}
\DoxyCodeLine{53   \textcolor{keywordtype}{void} EnqueueStatReqs(\textcolor{keyword}{const} \mbox{\hyperlink{namespacejson_a14165bfd985e982794b3697b71cc4a01}{json::Dict}} \&doc\_map);}
\DoxyCodeLine{54 }
\DoxyCodeLine{56   \textcolor{keywordtype}{void} \mbox{\hyperlink{classjson_1_1JsonReader_ad8d5cad8c8473d9a9eb3191648d60e06}{ParseSingleCommand}}(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{57 }
\DoxyCodeLine{62   \textcolor{keywordtype}{void} \mbox{\hyperlink{classjson_1_1JsonReader_aa522cb4e7785b59b59d5a49c020475bb}{InsertAllIntoCatalogue}}();}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{keyword}{private}:}
\DoxyCodeLine{66   \mbox{\hyperlink{classcore_1_1TransportCatalogue}{core::TransportCatalogue}} \&\mbox{\hyperlink{classjson_1_1JsonReader_a0ae996e195f14f7542c53414497c2fa2}{catalogue\_}};}
\DoxyCodeLine{68   \mbox{\hyperlink{classcore_1_1RequestHandler}{core::RequestHandler}} \&\mbox{\hyperlink{classjson_1_1JsonReader_a8321a0cc06e0e2e04e73c6622471e1ba}{req\_handler\_}};}
\DoxyCodeLine{69 }
\DoxyCodeLine{74   \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes}{RequestTypes}} \{}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1StopInsert}{StopInsert}} \{}
\DoxyCodeLine{77       \mbox{\hyperlink{structinput__info_1_1Stop}{input\_info::Stop}} *stop\_ptr;}
\DoxyCodeLine{78     \};}
\DoxyCodeLine{79 }
\DoxyCodeLine{80     \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1StopLinkInsert}{StopLinkInsert}} \{}
\DoxyCodeLine{81       \mbox{\hyperlink{structinput__info_1_1StopLink}{input\_info::StopLink}} *stoplink\_ptr;}
\DoxyCodeLine{82     \};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1BusInsert}{BusInsert}} \{}
\DoxyCodeLine{85       \mbox{\hyperlink{structinput__info_1_1Bus}{input\_info::Bus}} *bus\_ptr;}
\DoxyCodeLine{86     \};}
\DoxyCodeLine{87   \};}
\DoxyCodeLine{88 }
\DoxyCodeLine{90   \textcolor{keyword}{using }\mbox{\hyperlink{classjson_1_1JsonReader_a9133bfe72e1c7a6f7bc8002fca3234d5}{InputQueue}} =}
\DoxyCodeLine{91       std::variant<\mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1StopInsert}{RequestTypes::StopInsert}}, \mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1StopLinkInsert}{RequestTypes::StopLinkInsert}},}
\DoxyCodeLine{92                    \mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1BusInsert}{RequestTypes::BusInsert}}>;}
\DoxyCodeLine{93 }
\DoxyCodeLine{98   \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonInputParse}{JsonInputParse}} \{}
\DoxyCodeLine{99   \textcolor{keyword}{public}:}
\DoxyCodeLine{100     \textcolor{keyword}{explicit} \mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonInputParse}{JsonInputParse}}(\mbox{\hyperlink{classjson_1_1JsonReader}{JsonReader}} \&parent) : parent\_\{parent\} \{\};}
\DoxyCodeLine{101     \textcolor{keywordtype}{void} operator()(std::string\_view type, \textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{102 }
\DoxyCodeLine{103   \textcolor{keyword}{private}:}
\DoxyCodeLine{104     \textcolor{keyword}{using }FunctionPtr = void (\mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonInputParse}{JsonInputParse}}::*)(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&);}
\DoxyCodeLine{107     \textcolor{keyword}{static} std::unordered\_map<std::string\_view, FunctionPtr> \mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonInputParse_abab03b8d07772338734e07cd7401bf26}{handlers\_}};}
\DoxyCodeLine{108     \mbox{\hyperlink{classjson_1_1JsonReader}{JsonReader}} \&parent\_;}
\DoxyCodeLine{109     \textcolor{keywordtype}{void} EnqueueBus(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{110     \textcolor{keywordtype}{void} EnqueueStop(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{111   \} json\_input\_parser\_\{*\textcolor{keyword}{this}\};}
\DoxyCodeLine{112 }
\DoxyCodeLine{117   \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonPrintParse}{JsonPrintParse}} \{}
\DoxyCodeLine{118   \textcolor{keyword}{public}:}
\DoxyCodeLine{119     \textcolor{keyword}{using }\mbox{\hyperlink{structcore_1_1RequestHandler_1_1RequestTypes}{RequestTypes}} = \mbox{\hyperlink{structcore_1_1RequestHandler_1_1RequestTypes}{core::RequestHandler::RequestTypes}};}
\DoxyCodeLine{120     \textcolor{keyword}{explicit} \mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonPrintParse}{JsonPrintParse}}(\mbox{\hyperlink{classcore_1_1RequestHandler}{core::RequestHandler}} \&parent) : parent\_\{parent\} \{\};}
\DoxyCodeLine{121     \textcolor{keywordtype}{void} operator()(std::string\_view type, \textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{122 }
\DoxyCodeLine{123   \textcolor{keyword}{private}:}
\DoxyCodeLine{124     \textcolor{keyword}{using }FunctionPtr = void (\mbox{\hyperlink{structjson_1_1JsonReader_1_1JsonPrintParse}{JsonPrintParse}}::*)(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&);}
\DoxyCodeLine{125     \textcolor{keyword}{static} std::unordered\_map<std::string\_view, FunctionPtr> handlers\_;}
\DoxyCodeLine{126     \mbox{\hyperlink{classcore_1_1RequestHandler}{core::RequestHandler}} \&parent\_;}
\DoxyCodeLine{127     \textcolor{keywordtype}{void} EnqueueBus(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{128     \textcolor{keywordtype}{void} EnqueueStop(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{129     \textcolor{keywordtype}{void} EnqueueMapDraw(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{130     \textcolor{keywordtype}{void} EnqueueRoute(\textcolor{keyword}{const} \mbox{\hyperlink{classjson_1_1Node}{json::Node}} \&node);}
\DoxyCodeLine{131   \} json\_print\_parser\_\{\mbox{\hyperlink{classjson_1_1JsonReader_a8321a0cc06e0e2e04e73c6622471e1ba}{req\_handler\_}}\};}
\DoxyCodeLine{132 }
\DoxyCodeLine{134   \textcolor{keyword}{struct }\mbox{\hyperlink{structjson_1_1JsonReader_1_1CatalogueInserter}{CatalogueInserter}} \{}
\DoxyCodeLine{135   \textcolor{keyword}{public}:}
\DoxyCodeLine{136     \textcolor{keyword}{explicit} \mbox{\hyperlink{structjson_1_1JsonReader_1_1CatalogueInserter}{CatalogueInserter}}(\mbox{\hyperlink{classjson_1_1JsonReader}{JsonReader}} \&parent) : parent\_\{parent\} \{\};}
\DoxyCodeLine{137     \textcolor{keywordtype}{void} operator()(\textcolor{keyword}{const} \mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1StopInsert}{RequestTypes::StopInsert}} \&req);}
\DoxyCodeLine{138     \textcolor{keywordtype}{void} operator()(\textcolor{keyword}{const} \mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1StopLinkInsert}{RequestTypes::StopLinkInsert}} \&req);}
\DoxyCodeLine{139     \textcolor{keywordtype}{void} operator()(\textcolor{keyword}{const} \mbox{\hyperlink{structjson_1_1JsonReader_1_1RequestTypes_1_1BusInsert}{RequestTypes::BusInsert}} \&req);}
\DoxyCodeLine{140 }
\DoxyCodeLine{141   \textcolor{keyword}{private}:}
\DoxyCodeLine{142     \mbox{\hyperlink{classjson_1_1JsonReader}{JsonReader}} \&parent\_;}
\DoxyCodeLine{143   \} catalogue\_inserter\_\{*\textcolor{keyword}{this}\};}
\DoxyCodeLine{144 }
\DoxyCodeLine{149   std::vector<InputQueue> \mbox{\hyperlink{classjson_1_1JsonReader_a4adb8145f324953004212c2d52dfc12f}{input\_queue\_}};}
\DoxyCodeLine{150 }
\DoxyCodeLine{157   std::deque<input\_info::Stop> \mbox{\hyperlink{classjson_1_1JsonReader_a77c396487f2cec76b8e32a463a1c9e79}{stops\_input\_queue\_}};}
\DoxyCodeLine{158 }
\DoxyCodeLine{160   std::deque<input\_info::StopLink> \mbox{\hyperlink{classjson_1_1JsonReader_a79662e90cc941bcc23ef4f59da11b674}{stoplinks\_input\_queue\_}};}
\DoxyCodeLine{161 }
\DoxyCodeLine{163   std::deque<input\_info::Bus> \mbox{\hyperlink{classjson_1_1JsonReader_a18c6fcb6deaaab63f3a7c565b2c42650}{buses\_input\_queue\_}};}
\DoxyCodeLine{164 }
\DoxyCodeLine{169   \textcolor{keywordtype}{void} \mbox{\hyperlink{classjson_1_1JsonReader_a98ae55d9c072d5ac31b7585029ddb5eb}{Clear}}();}
\DoxyCodeLine{170 \};}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \} \textcolor{comment}{// namespace json}}

\end{DoxyCode}
